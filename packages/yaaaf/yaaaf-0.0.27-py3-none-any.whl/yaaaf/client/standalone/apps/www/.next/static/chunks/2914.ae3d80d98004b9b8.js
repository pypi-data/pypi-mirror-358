"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2914],{2914:(e,t,r)=>{r.r(t),r.d(t,{AudioVisualizer:()=>i});var n=r(57437),c=r(2265);let l={FFT_SIZE:512,SMOOTHING:.8,MIN_BAR_HEIGHT:2,MIN_BAR_WIDTH:2,BAR_SPACING:1,COLOR:{MIN_INTENSITY:100,MAX_INTENSITY:255,INTENSITY_RANGE:155}};function i(e){let{stream:t,isRecording:r,onClick:i}=e,u=(0,c.useRef)(null),a=(0,c.useRef)(null),o=(0,c.useRef)(null),s=(0,c.useRef)(),f=(0,c.useRef)(null),h=()=>{s.current&&cancelAnimationFrame(s.current),a.current&&a.current.close()};(0,c.useEffect)(()=>h,[]),(0,c.useEffect)(()=>{t&&r?d():h()},[t,r]),(0,c.useEffect)(()=>{let e=()=>{if(u.current&&f.current){let e=f.current,t=u.current,r=window.devicePixelRatio||1,n=e.getBoundingClientRect();t.width=(n.width-2)*r,t.height=(n.height-2)*r,t.style.width="".concat(n.width-2,"px"),t.style.height="".concat(n.height-2,"px")}};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);let d=async()=>{try{let e=new AudioContext;a.current=e;let r=e.createAnalyser();r.fftSize=l.FFT_SIZE,r.smoothingTimeConstant=l.SMOOTHING,o.current=r,e.createMediaStreamSource(t).connect(r),R()}catch(e){console.error("Error starting visualization:",e)}},I=e=>{let t=Math.floor(e*l.COLOR.INTENSITY_RANGE)+l.COLOR.MIN_INTENSITY;return"rgb(".concat(t,", ").concat(t,", ").concat(t,")")},N=(e,t,r,n,c,l)=>{e.fillStyle=l,e.fillRect(t,r-c,n,c),e.fillRect(t,r,n,c)},R=()=>{if(!r)return;let e=u.current,t=null==e?void 0:e.getContext("2d");if(!e||!t||!o.current)return;let n=window.devicePixelRatio||1;t.scale(n,n);let c=o.current,i=c.frequencyBinCount,a=new Uint8Array(i),f=()=>{s.current=requestAnimationFrame(f),c.getByteFrequencyData(a),t.clearRect(0,0,e.width/n,e.height/n);let r=Math.max(l.MIN_BAR_WIDTH,e.width/n/i-l.BAR_SPACING),u=e.height/n/2,o=0;for(let e=0;e<i;e++){let n=a[e]/255,c=Math.max(l.MIN_BAR_HEIGHT,n*u);N(t,o,u,r,c,I(n)),o+=r+l.BAR_SPACING}};f()};return(0,n.jsx)("div",{ref:f,className:"h-full w-full cursor-pointer rounded-lg bg-background/80 backdrop-blur",onClick:i,children:(0,n.jsx)("canvas",{ref:u,className:"h-full w-full"})})}}}]);
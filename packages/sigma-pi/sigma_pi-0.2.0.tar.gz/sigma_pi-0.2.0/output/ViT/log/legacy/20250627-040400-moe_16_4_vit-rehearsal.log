Logging output to: output/ViT/log\20250627-040400-moe_16_4_vit-rehearsal.log
Loading checkpoint from: output/ViT/checkpoints/20250626-153515-moe_16_4_vit-single-epoch_20.pth
Model: -rehearsal-rehearsal
Total Trainable Parameters: 1.23M

==================================================
          STAGE 2 (Rehearsal): Training on SVHN with CIFAR-10 Rehearsal
==================================================


--- Training on SVHN for 4 epochs ---

--- Epoch 21 ---
Train Epoch 21 Summary: Avg loss: 2.1383, Avg Accuracy: 26.28%, Avg PI: 0.2911, Avg Surprise: 1.8357, Avg Tau: 1.9977
CIFAR10_Val set: Avg loss: 2.8971, Accuracy: 13.55%, Avg PI: 0.0290, Avg Surprise: 5.5361, Avg Tau: 1.8455
SVHN_Val set: Avg loss: 1.7058, Accuracy: 41.21%, Avg PI: 0.1375, Avg Surprise: 3.0302, Avg Tau: 1.7704

--- Epoch 22 ---
Train Epoch 22 Summary: Avg loss: 1.6084, Avg Accuracy: 44.25%, Avg PI: 0.2228, Avg Surprise: 2.0415, Avg Tau: 1.6017
CIFAR10_Val set: Avg loss: 3.1520, Accuracy: 11.39%, Avg PI: 0.0173, Avg Surprise: 6.2060, Avg Tau: 1.6358
SVHN_Val set: Avg loss: 1.2614, Accuracy: 56.77%, Avg PI: 0.1130, Avg Surprise: 3.4378, Avg Tau: 1.3434

--- Epoch 23 ---
Train Epoch 23 Summary: Avg loss: 1.3318, Avg Accuracy: 54.08%, Avg PI: 0.1961, Avg Surprise: 2.2994, Avg Tau: 1.3317
CIFAR10_Val set: Avg loss: 3.0511, Accuracy: 12.37%, Avg PI: 0.0178, Avg Surprise: 6.2114, Avg Tau: 1.6304
SVHN_Val set: Avg loss: 1.0603, Accuracy: 64.17%, Avg PI: 0.1188, Avg Surprise: 3.3127, Avg Tau: 1.0958

--- Epoch 24 ---
Train Epoch 24 Summary: Avg loss: 1.1652, Avg Accuracy: 60.32%, Avg PI: 0.2022, Avg Surprise: 2.2393, Avg Tau: 1.1701
CIFAR10_Val set: Avg loss: 3.0492, Accuracy: 10.80%, Avg PI: 0.0151, Avg Surprise: 6.5848, Avg Tau: 1.6662
SVHN_Val set: Avg loss: 0.8807, Accuracy: 71.04%, Avg PI: 0.1227, Avg Surprise: 3.3159, Avg Tau: 0.9705

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_24.pth

--- Rehearsal on CIFAR-10 for 1 epoch ---

--- Epoch 25 ---
Train Epoch 25 Summary: Avg loss: 1.5716, Avg Accuracy: 44.17%, Avg PI: 0.2727, Avg Surprise: 1.6903, Avg Tau: 1.5267
CIFAR10_Val set: Avg loss: 1.0819, Accuracy: 61.12%, Avg PI: 0.2446, Avg Surprise: 1.7645, Avg Tau: 1.0214
SVHN_Val set: Avg loss: 3.8330, Accuracy: 14.69%, Avg PI: 0.0054, Avg Surprise: 7.7150, Avg Tau: 1.3690

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_25.pth

--- Training on SVHN for 4 epochs ---

--- Epoch 26 ---
Train Epoch 26 Summary: Avg loss: 1.5252, Avg Accuracy: 49.12%, Avg PI: 0.2027, Avg Surprise: 2.3527, Avg Tau: 1.4369
CIFAR10_Val set: Avg loss: 2.7201, Accuracy: 16.42%, Avg PI: 0.0259, Avg Surprise: 5.6442, Avg Tau: 1.6091
SVHN_Val set: Avg loss: 0.9945, Accuracy: 66.67%, Avg PI: 0.0835, Avg Surprise: 4.0029, Avg Tau: 0.9712

--- Epoch 27 ---
Train Epoch 27 Summary: Avg loss: 1.0526, Avg Accuracy: 64.39%, Avg PI: 0.2113, Avg Surprise: 2.1526, Avg Tau: 1.0625
CIFAR10_Val set: Avg loss: 2.8022, Accuracy: 15.07%, Avg PI: 0.0195, Avg Surprise: 6.1537, Avg Tau: 1.6080
SVHN_Val set: Avg loss: 0.7964, Accuracy: 73.48%, Avg PI: 0.1382, Avg Surprise: 2.9860, Avg Tau: 0.8027

--- Epoch 28 ---
Train Epoch 28 Summary: Avg loss: 0.9608, Avg Accuracy: 67.67%, Avg PI: 0.2327, Avg Surprise: 1.9433, Avg Tau: 0.9676
CIFAR10_Val set: Avg loss: 2.7535, Accuracy: 14.06%, Avg PI: 0.0276, Avg Surprise: 5.5698, Avg Tau: 1.6692
SVHN_Val set: Avg loss: 0.7162, Accuracy: 76.53%, Avg PI: 0.1743, Avg Surprise: 2.4946, Avg Tau: 0.7062

--- Epoch 29 ---
Train Epoch 29 Summary: Avg loss: 0.9119, Avg Accuracy: 69.41%, Avg PI: 0.2337, Avg Surprise: 1.9315, Avg Tau: 0.9135
CIFAR10_Val set: Avg loss: 2.8695, Accuracy: 12.62%, Avg PI: 0.0215, Avg Surprise: 5.9572, Avg Tau: 1.6329
SVHN_Val set: Avg loss: 0.7112, Accuracy: 76.72%, Avg PI: 0.1319, Avg Surprise: 3.0095, Avg Tau: 0.6708

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_29.pth

--- Rehearsal on CIFAR-10 for 1 epoch ---

--- Epoch 30 ---
Train Epoch 30 Summary: Avg loss: 1.5032, Avg Accuracy: 46.34%, Avg PI: 0.2593, Avg Surprise: 1.7651, Avg Tau: 1.4598
CIFAR10_Val set: Avg loss: 1.0956, Accuracy: 59.77%, Avg PI: 0.2278, Avg Surprise: 1.9070, Avg Tau: 1.0296
SVHN_Val set: Avg loss: 3.5333, Accuracy: 20.00%, Avg PI: 0.0064, Avg Surprise: 7.4573, Avg Tau: 1.3001

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_30.pth

--- Training on SVHN for 2 epochs ---

--- Epoch 31 ---
Train Epoch 31 Summary: Avg loss: 1.1940, Avg Accuracy: 61.52%, Avg PI: 0.2207, Avg Surprise: 2.2247, Avg Tau: 1.1171
CIFAR10_Val set: Avg loss: 2.5870, Accuracy: 18.53%, Avg PI: 0.0268, Avg Surprise: 5.6253, Avg Tau: 1.5795
SVHN_Val set: Avg loss: 0.7043, Accuracy: 76.97%, Avg PI: 0.1403, Avg Surprise: 2.8660, Avg Tau: 0.6478

--- Epoch 32 ---
Train Epoch 32 Summary: Avg loss: 0.8533, Avg Accuracy: 71.49%, Avg PI: 0.2442, Avg Surprise: 1.8478, Avg Tau: 0.8613
CIFAR10_Val set: Avg loss: 2.5524, Accuracy: 17.43%, Avg PI: 0.0228, Avg Surprise: 6.0419, Avg Tau: 1.6273
SVHN_Val set: Avg loss: 0.6581, Accuracy: 78.83%, Avg PI: 0.1340, Avg Surprise: 2.9732, Avg Tau: 0.6067

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_32.pth

--- Rehearsal on CIFAR-10 for 1 epoch ---

--- Epoch 33 ---
Train Epoch 33 Summary: Avg loss: 1.3734, Avg Accuracy: 51.39%, Avg PI: 0.2541, Avg Surprise: 1.8346, Avg Tau: 1.3462
CIFAR10_Val set: Avg loss: 1.0242, Accuracy: 63.72%, Avg PI: 0.2480, Avg Surprise: 1.7486, Avg Tau: 0.9719
SVHN_Val set: Avg loss: 2.8143, Accuracy: 23.15%, Avg PI: 0.0084, Avg Surprise: 7.5467, Avg Tau: 1.3693

Checkpoint saved to: output/ViT/checkpoints\-rehearsal-rehearsal-epoch_33.pth

Plots for full experiment saved to: E:\Dev\Chain\SigmaPI\output\ViT

==================================================
                  FINAL EVALUATION
==================================================

--- Final performance for model: -rehearsal-rehearsal ---
Final CIFAR-10 Val set: Avg loss: 1.0242, Accuracy: 63.72%, Avg PI: 0.2480, Avg Surprise: 1.7486, Avg Tau: 0.9719
Final SVHN Val set: Avg loss: 2.8143, Accuracy: 23.15%, Avg PI: 0.0084, Avg Surprise: 7.5467, Avg Tau: 1.3693

"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[42124],{42124:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a,triggerAstStatusCheck:()=>d});var o=n(65043),s=n(89073),i=n(97606),r=n(57692);var c=n(55727),l=n(70579);const d=()=>{window.dispatchEvent(new CustomEvent("ast-config-changed"))},a=()=>{const[e,t]=(0,o.useState)(null),[n,d]=(0,o.useState)(!1),[a,f]=(0,o.useState)(!1),{isDarkMode:u}=(0,c.D)();if((0,o.useEffect)((()=>{let e=null,n=!0;const o=async()=>{try{const s=await(async()=>{try{const e=await fetch("/api/ast/status");if(!e.ok)throw new Error("HTTP error! Status: ".concat(e.status));return await e.json()}catch(e){return console.error("Error fetching AST status:",e),{is_indexing:!1,completion_percentage:0,is_complete:!1,indexed_files:0,total_files:0,elapsed_seconds:null,error:e instanceof Error?e.message:"Unknown error"}}})();n&&(t(s),(s.is_indexing||s.is_complete)&&f(!0),(s.is_indexing||s.error)&&d(!0),s.is_complete&&!s.error&&setTimeout((()=>{n&&d(!1)}),5e3),s.is_indexing&&!s.is_complete&&(e=window.setTimeout(o,3e3)))}catch(s){console.error("Error checking AST status:",s),a&&n&&(e=window.setTimeout(o,3e3))}};o();const s=()=>{"visible"===document.visibilityState?!e&&n&&o():e&&(window.clearTimeout(e),e=null)};document.addEventListener("visibilitychange",s);const i=()=>{f(!1),o()};return window.addEventListener("ast-config-changed",i),()=>{n=!1,e&&window.clearTimeout(e),document.removeEventListener("visibilitychange",s),window.removeEventListener("ast-config-changed",i)}}),[a]),!e||!n)return null;if(e.error)return a?(0,l.jsx)(s.A,{className:"ast-status-error",style:{position:"fixed",bottom:"10px",right:"10px",width:"300px",backgroundColor:u?"#2a1f1f":"#fff1f0",borderColor:u?"#a61d24":"#ffa39e",color:u?"#ff7875":void 0},children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"AST Indexing Error"}),(0,l.jsx)("p",{children:e.error})]})}):null;if(e.is_indexing&&!e.is_complete){const t=e.elapsed_seconds?" (".concat((e=>{if(!e)return"";if(e<60)return"".concat(Math.round(e),"s");if(e<3600){const t=Math.floor(e/60),n=Math.round(e%60);return"".concat(t,"m ").concat(n,"s")}{const t=Math.floor(e/3600),n=Math.floor(e%3600/60);return"".concat(t,"h ").concat(n,"m")}})(e.elapsed_seconds),")"):"";return(0,l.jsx)(s.A,{className:"ast-status-indicator",style:{position:"fixed",bottom:"10px",right:"10px",width:"300px",backgroundColor:u?"#141414":"#ffffff",borderColor:u?"#303030":"#d9d9d9",color:u?"#ffffff":void 0},children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,l.jsx)("strong",{children:"AST Indexing"}),(0,l.jsxs)("span",{children:[e.completion_percentage,"%",t]})]}),(0,l.jsx)(i.A,{title:"".concat(e.indexed_files,"/").concat(e.total_files," files processed"),children:(0,l.jsx)(r.A,{percent:e.completion_percentage,size:"small",status:"active",showInfo:!1})}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#8c8c8c",marginTop:"4px"},children:[e.indexed_files,"/",e.total_files," files processed"]})]})})}return e.is_complete?(0,l.jsx)(s.A,{className:"ast-status-complete",style:{position:"fixed",bottom:"10px",right:"10px",width:"300px",backgroundColor:u?"#162312":"#f6ffed",borderColor:u?"#389e0d":"#b7eb8f",color:u?"#ffffff":void 0},children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"AST Indexing Complete"}),(0,l.jsxs)("div",{style:{fontSize:"12px",color:"#8c8c8c",marginTop:"4px"},children:[e.indexed_files," files indexed"]})]})}):null}}}]);
//# sourceMappingURL=42124.2b7c41a3.chunk.js.map
import"./Bg9kRutz.mjs";import{i as ne}from"./DTpo0kgr.mjs";import{p as oe,h as m,b as R,r as v,c as F,d as ve,i as A,l as j,a as pe,V as _,g as c,m as H,s as O,T as J,e as Re,f as me,aP as Ne}from"./DvQPdglG.mjs";import{p as X,i as te}from"./jy7gnWqU.mjs";import{X as qe,Y as Me,Z as Ie,_ as Pe,$ as Ke,a0 as Ye,a1 as Le,a2 as $e,a3 as Be,a4 as ke,a5 as Fe,a6 as We,a7 as Ge,a8 as Oe,a9 as Ue,aa as ze,ab as je,ac as He,ad as Ve,ae as Je,af as Xe,ag as Ze,ah as Qe,ai as et,aj as tt,ak as at,q as we,al as xe,am as rt,an as it,ao as st,ap as lt,aq as nt,ar as ot,as as vt,at as ct,au as dt,u as ut,av as de,aw as ft,ax as mt,ay as pt,az as gt,T as ht}from"./BVoZyvfW.mjs";import{C as bt}from"./BBeIjo2R.mjs";import{e as Q,i as ee,R as he}from"./BHETkb4X.mjs";import{s as k}from"./DWmaQdPb.mjs";import{t as W,D as yt,T as _t,b as Te}from"./CTBFerHA.mjs";import{b as St}from"./CVnLI7kJ.mjs";import{R as Y}from"./D1yVOiR4.mjs";import{y as wt,z as be,A as xt,B as Dt,C as Rt,D as Lt,E as $t,F as De,G as kt,H as Ft,I as Tt,J as Ct,K as Et,N as At,L as Nt,M as qt}from"./DD48U--W.mjs";import{m as Mt}from"./D1slsF82.mjs";import{t as It}from"./BvqCLZw2.mjs";import{b as ue}from"./Hy6HsZIe.mjs";import{b as Pt}from"./Bc5MJCE7.mjs";import{s as Kt,b as le,a as Yt}from"./B2Ge_TJA.mjs";import{w as Bt}from"./CAXUivPC.mjs";var Wt=A('<div class="card-info-placeholder svelte-16vamgt"> </div>');function Gt(l,f){oe(f,!1),ne();var n=Wt(),e=m(n,!0);R(()=>k(e,qe())),v(n),F(l,n),ve()}var Ot=A('<tr><th class="align-start svelte-1ws7hzc"> </th><td> </td></tr>'),Ut=A('<table class="stats-table align-start svelte-1ws7hzc"><tbody></tbody></table>');function zt(l,f){oe(f,!1);let n=X(f,"stats",8);function e(t){return new Te(Number(t)).dateString()}function b(t){const r=[];if(r.push({label:Me(),value:e(t.added)}),t.firstReview!=null&&r.push({label:Ie(),value:e(t.firstReview)}),t.latestReview!=null&&r.push({label:Pe(),value:e(t.latestReview)}),t.dueDate!=null&&r.push({label:Ke(),value:e(t.dueDate)}),t.duePosition!=null&&r.push({label:Ye(),value:t.duePosition}),t.interval&&r.push({label:Le(),value:W(t.interval*yt)}),t.memoryState){let h=W(t.memoryState.stability*86400,!1,!1);if(t.memoryState.stability>31){const a=W(t.memoryState.stability*86400,!1,!1,_t.Days);h+=` (${a})`}r.push({label:$e(),value:h});const S=((t.memoryState.difficulty-1)/9*100).toFixed(0);if(r.push({label:Be(),value:`${S}%`}),t.fsrsRetrievability){const a=(t.fsrsRetrievability*100).toFixed(0);r.push({label:ke(),value:`${a}%`})}}else t.ease&&r.push({label:Fe(),value:`${t.ease/10}%`});r.push({label:We(),value:t.reviews}),r.push({label:Ge(),value:t.lapses}),t.totalSecs&&(r.push({label:Oe(),value:W(t.averageSecs)}),r.push({label:Ue(),value:W(t.totalSecs)})),r.push({label:ze(),value:t.cardType}),r.push({label:je(),value:t.notetype});let u;if(t.originalDeck?u=`${t.deck} (${t.originalDeck})`:u=t.deck,r.push({label:He(),value:u}),r.push({label:Ve(),value:t.preset}),r.push({label:Je(),value:t.cardId}),r.push({label:Xe(),value:t.noteId}),t.customData){let h;try{const S=JSON.parse(t.customData);h=Object.entries(S).map(([a,d])=>`${a}=${d}`).join(" ")}catch{h=t.customData}r.push({label:Ze(),value:h})}return r}let s=H();j(()=>J(n()),()=>{O(s,b(n()))}),pe(),ne();var o=Ut(),C=m(o);Q(C,5,()=>c(s),ee,(t,r)=>{var u=Ot(),h=m(u),S=m(h,!0);v(h);var a=_(h),d=m(a,!0);v(a),v(u),R(()=>{k(S,c(r).label),k(d,c(r).value)}),F(t,u)}),v(C),v(o),F(l,o),ve()}const jt=1e3;function fe(l,f,n){const e=Math.pow(.9,1/-n)-1;return Math.pow(f/l*e+1,-n)}var D=(l=>(l[l.Week=0]="Week",l[l.Month=1]="Month",l[l.Year=2]="Year",l[l.AllTime=3]="AllTime",l))(D||{});const Ht={0:7,1:30,2:365,3:1/0};function Vt(l,f){return l.filter(n=>n.daysSinceFirstLearn<=f)}function ye(l){return l.reviewKind!==Y.MANUAL&&l.reviewKind!==Y.RESCHEDULED&&(l.reviewKind!==Y.FILTERED||l.ease!==0)}function Jt(l){const f=[];for(const n of l){if(n.reviewKind===Y.MANUAL&&n.ease===0||n.memoryState===void 0)break;f.push(n)}return f.filter(n=>ye(n))}function Xt(l,f,n){const e=[];let b=0,s=0;const o=Math.min(f/jt,1);let C=0;if(l.slice().reverse().forEach((g,p)=>{var M,N;const E=Number(g.time);if(p===0){b=E,s=((M=g.memoryState)==null?void 0:M.stability)||0,e.push({date:new Date(E*1e3),daysSinceFirstLearn:0,elapsedDaysSinceLastReview:0,retrievability:100,stability:s});return}const I=(E-b)/86400;let L=0;for(;L<I-o;){L+=o;const i=fe(s,L,n);e.push({date:new Date((b+L*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:L,retrievability:i*100,stability:s})}C+=I,e.push({date:new Date((b+I*86400)*1e3),daysSinceFirstLearn:C,retrievability:100,elapsedDaysSinceLastReview:0,stability:s}),b=E,s=((N=g.memoryState)==null?void 0:N.stability)||0}),e.length===0)return[];const t=Date.now()/1e3,r=(t-b)/86400;let u=0;for(;u<r-o;){u+=o;const g=fe(s,u,n);e.push({date:new Date((b+u*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:u,retrievability:g*100,stability:s})}C+=r;const h=fe(s,r,n);e.push({date:new Date(t*1e3),daysSinceFirstLearn:C,elapsedDaysSinceLastReview:r,retrievability:h*100,stability:s});const S=f-r;let a=0;for(;a<S;){a+=o;const g=fe(s,u+a,n);e.push({date:new Date((t+a*86400)*1e3),daysSinceFirstLearn:e[e.length-1].daysSinceFirstLearn+o,elapsedDaysSinceLastReview:r+a,retrievability:g*100,stability:s})}return Vt(e,f)}function Ce(l,f){if(l.length===0)return 0;const n=new Date,e=(n.getTime()/1e3-Number(l[l.length-1].time))/86400,b=(n.getTime()/1e3-Number(l[0].time))/86400,s=l[0].interval/86400,o=Math.max(s*1.5-b,s*.5);return Math.min(e+o,Ht[f])}function Zt(l,f,n,e,b,s){const o=wt(n),C=o.transition().duration(600);if(l.length===0){be(o,!1);return}const t=Ce(l,f),r=Xt(l,t,s);if(r.length===0){be(o,!1);return}else be(o,!0);o.selectAll(".forgetting-curve-line").remove(),o.select(".hover-columns").remove();const u=Mt(r,i=>i.date),h=xt(r,i=>i.date),S=It().domain([u,h]).range([e.marginLeft,e.width-e.marginRight]),a=Math.max(0,100-1.2*(100-Math.min(...r.map(i=>i.retrievability)))),d=Dt().domain([a,100]).range([e.height-e.marginBottom,e.marginTop]);o.select(".x-ticks").call(i=>i.transition(C).call(Rt(S).ticks(5).tickSizeOuter(0))).attr("direction","ltr"),o.select(".y-ticks").attr("transform",`translate(${e.marginLeft},0)`).call(i=>i.transition(C).call(Lt(d).tickSizeOuter(0))).attr("direction","ltr"),o.select(".y-ticks .y-axis-title").remove(),o.select(".y-ticks").append("text").attr("class","y-axis-title").attr("transform","rotate(-90)").attr("y",0-e.marginLeft).attr("x",0-e.height/2).attr("font-size","1rem").attr("dy","1.1em").attr("fill","currentColor");const g=$t().x(i=>S(i.date)).y(i=>d(i.retrievability)),p=b*100;o.append("linearGradient").attr("id","line-gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",d(0)).attr("x2",0).attr("y2",d(100)).selectAll("stop").data([{offset:"0%",color:"tomato"},{offset:`${p}%`,color:"steelblue"},{offset:"100%",color:"green"}]).enter().append("stop").attr("offset",i=>i.offset).attr("stop-color",i=>i.color);const E=new Date,I=r.filter(i=>i.date<=E),L=r.filter(i=>i.date>=E);o.append("path").datum(I).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("d",g),o.append("path").datum(L).attr("class","forgetting-curve-line").attr("fill","none").attr("stroke","url(#line-gradient)").attr("stroke-width",1.5).attr("stroke-dasharray","4 4").attr("d",g),o.select(".desired-retention-line").remove(),p>a&&o.append("line").attr("class","desired-retention-line").attr("x1",e.marginLeft).attr("x2",e.width-e.marginRight).attr("y1",d(p)).attr("y2",d(p)).attr("stroke","steelblue").attr("stroke-dasharray","4 4").attr("stroke-width",1.2);const M=o.append("line").attr("class","focus-line").attr("y1",e.marginTop).attr("y2",e.height-e.marginBottom).attr("stroke","black").attr("stroke-width",1).style("opacity",0);function N(i){return`${t>=365?"Date":"Date Time"}: ${t>=365?i.date.toLocaleDateString():i.date.toLocaleString()}<br>
        ${et()}: ${W(i.elapsedDaysSinceLastReview*86400)}<br>${ke()}: ${i.retrievability.toFixed(2)}%<br>${$e()}: ${W(i.stability*86400)}`}o.append("g").attr("class","hover-columns").selectAll("rect").data(r).join("rect").attr("x",i=>S(i.date)-1).attr("y",e.marginTop).attr("width",2).attr("height",e.height-e.marginTop-e.marginBottom).attr("fill","transparent").on("mousemove",(i,w)=>{const[T,U]=De(i,document.body),[ie,z]=De(i,o.node()),B=d(p);M.attr("x1",S(w.date)-1).attr("x2",S(w.date)+1).style("opacity",1);let Z=N(w);const ae=b*100;z>=B-10&&z<=B+10&&(Z+=`<br>${Qe()}: ${ae.toFixed(0)}%`),kt(Z,T,U)}).on("mouseout",()=>{M.style("opacity",0),Ft()})}var Qt=A('<div class="svelte-1bf093q"><b> </b> <span class="hidden-xs svelte-1bf093q"> </span></div>'),ea=A("<div> </div>"),ta=A("<div> </div>"),aa=A('<div class="svelte-1bf093q"> </div>'),ra=A('<div class="svelte-1bf093q"> </div>'),ia=A('<div class="svelte-1bf093q"> </div>'),sa=A('<div class="revlog-table svelte-1bf093q"><div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div> <div class="column hidden-xs svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content svelte-1bf093q"></div></div> <div class="column svelte-1bf093q"><div class="column-head svelte-1bf093q"> </div> <div class="column-content right svelte-1bf093q"></div></div></div>');function la(l,f){oe(f,!1);const n=H();let e=X(f,"revlog",8);const b=!1;function s(a){switch(a.reviewKind){case Y.LEARNING:return"revlog-learn";case Y.REVIEW:return"revlog-review";case Y.RELEARNING:return"revlog-relearn"}return""}function o(a){switch(a.reviewKind){case Y.LEARNING:return ct();case Y.REVIEW:return vt();case Y.RELEARNING:return ot();case Y.FILTERED:return nt();case Y.MANUAL:return lt();case Y.RESCHEDULED:return st()}}function C(a){return a.buttonChosen===1?"revlog-ease1":""}function t(a,d){var p;const g=new Te(Number(a.time));return{date:g.dateString(),time:g.timeString(),reviewKind:o(a),reviewKindClass:s(a),rating:a.buttonChosen,ratingClass:C(a),interval:W(a.interval),ease:r(a.ease),takenSecs:W(a.takenSecs,!0),elapsedTime:d,stability:(p=a.memoryState)!=null&&p.stability?W(a.memoryState.stability*86400):""}}function r(a){if(a===0)return"";const d=a/10;return d<=110?`D:${(d-10).toFixed(0)}%`:`${d.toFixed(0)}%`}j(()=>(J(e()),W),()=>{O(n,e().map((a,d)=>{let g,p=d+1;for(;p<e().length;){if(ye(e()[p])){g=e()[p];break}p++}let E="N/A";return ye(a)&&(E=g?W(Number(a.time)-Number(g.time)):"0"),t(a,E)}))}),pe(),ne();var u=Re(),h=me(u);{var S=a=>{var d=sa(),g=m(d),p=m(g),E=m(p,!0);R(()=>k(E,tt())),v(p);var I=_(p,2);Q(I,5,()=>c(n),ee,(q,x)=>{var y=Qt(),K=m(y),Ee=m(K,!0);v(K);var _e=_(K,2),Ae=m(_e);v(_e),v(y),R(()=>{var Se;k(Ee,c(x).date),k(Ae,`@ ${(Se=c(x).time)!=null?Se:""}`)}),F(q,y)}),v(I),v(g);var L=_(g,2),M=m(L),N=m(M,!0);R(()=>k(N,at())),v(M);var i=_(M,2);Q(i,5,()=>c(n),ee,(q,x)=>{var y=ea(),K=m(y,!0);v(y),R(()=>{we(y,xe(c(x).reviewKindClass),"svelte-1bf093q"),k(K,c(x).reviewKind)}),F(q,y)}),v(i),v(L);var w=_(L,2),T=m(w),U=m(T,!0);R(()=>k(U,rt())),v(T);var ie=_(T,2);Q(ie,5,()=>c(n),ee,(q,x)=>{var y=ta(),K=m(y,!0);v(y),R(()=>{we(y,xe(c(x).ratingClass),"svelte-1bf093q"),k(K,c(x).rating)}),F(q,y)}),v(ie),v(w);var z=_(w,2),B=m(z),Z=m(B,!0);R(()=>k(Z,Le())),v(B);var ae=_(B,2);Q(ae,5,()=>c(n),ee,(q,x)=>{var y=aa(),K=m(y,!0);v(y),R(()=>k(K,c(x).interval)),F(q,y)}),v(ae),v(z);var re=_(z,2),se=m(re),ge=m(se,!0);R(()=>k(ge,Fe())),v(se);var ce=_(se,2);Q(ce,5,()=>c(n),ee,(q,x)=>{var y=ra(),K=m(y,!0);v(y),R(()=>k(K,c(x).ease)),F(q,y)}),v(ce),v(re);var $=_(re,2),G=m($),P=m(G,!0);R(()=>k(P,it())),v(G);var V=_(G,2);Q(V,5,()=>c(n),ee,(q,x)=>{var y=ia(),K=m(y,!0);v(y),R(()=>k(K,c(x).takenSecs)),F(q,y)}),v(V),v($),v(d),F(a,d)};te(h,a=>{e().length>0&&a(S)})}return F(l,u),St(f,"fsrsEnabled",b),ve({fsrsEnabled:b})}var na=A('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),oa=A('<label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label>'),va=A('<div class="time-range-selector svelte-1niucon"><label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <label class="svelte-1niucon"><input type="radio" class="svelte-1niucon"> </label> <!> <!></div>'),ca=Ne("<svg><!><!><!></svg>"),da=A('<div class="forgetting-curve svelte-1niucon"><!> <!></div>');function ua(l,f){oe(f,!1);const n=Kt(),e=()=>Yt(d,"$timeRange",n),b=H(),s=H(),o=[];let C=X(f,"revlog",8),t=X(f,"desiredRetention",8),r=X(f,"decay",8),u=H(null);const h=Nt(),S=dt();let a=H(D.Week);const d=Bt(c(a));j(()=>J(C()),()=>{O(b,Jt(C()))}),j(()=>(c(b),D),()=>{O(s,Ce(c(b),D.AllTime))}),j(()=>(c(s),D),()=>{c(s)>365?O(a,D.AllTime):c(s)>30?O(a,D.Year):c(s)>7&&O(a,D.Month)}),j(()=>c(a),()=>{le(d,c(a))}),j(()=>(c(b),e(),c(u),J(t()),J(r())),()=>{Zt(c(b),e(),c(u),h,t(),r())}),pe(),ne();var g=da(),p=m(g);{var E=L=>{qt(L,{children:(M,N)=>{var i=va(),w=m(i),T=m(w);de(T);var U,ie=_(T);R(()=>{var $;return k(ie,` ${($=ft())!=null?$:""}`)}),v(w);var z=_(w,2),B=m(z);de(B);var Z,ae=_(B);R(()=>{var $;return k(ae,` ${($=mt())!=null?$:""}`)}),v(z);var re=_(z,2);{var se=$=>{var G=na(),P=m(G);de(P);var V,q=_(P);R(()=>{var x;return k(q,` ${(x=pt())!=null?x:""}`)}),v(G),R(()=>{V!==(V=D.Year)&&(P.value=(P.__value=D.Year)==null?"":D.Year)}),ue(o,[],P,()=>(D.Year,e()),x=>le(d,x)),F($,G)};te(re,$=>{c(s)>30&&$(se)})}var ge=_(re,2);{var ce=$=>{var G=oa(),P=m(G);de(P);var V,q=_(P);R(()=>{var x;return k(q,` ${(x=gt())!=null?x:""}`)}),v(G),R(()=>{V!==(V=D.AllTime)&&(P.value=(P.__value=D.AllTime)==null?"":D.AllTime)}),ue(o,[],P,()=>(D.AllTime,e()),x=>le(d,x)),F($,G)};te(ge,$=>{c(s)>365&&$(ce)})}v(i),R(()=>{U!==(U=D.Week)&&(T.value=(T.__value=D.Week)==null?"":D.Week),Z!==(Z=D.Month)&&(B.value=(B.__value=D.Month)==null?"":D.Month)}),ue(o,[],T,()=>(D.Week,e()),$=>le(d,$)),ue(o,[],B,()=>(D.Month,e()),$=>le(d,$)),F(M,i)},$$slots:{default:!0}})};te(p,L=>{c(s)>7&&L(E)})}var I=_(p,2);Tt(I,{title:S,children:(L,M)=>{var N=ca(),i=m(N);Ct(i,{bounds:h});var w=_(i);Et(w);var T=_(w);At(T,{bounds:h}),v(N),Pt(N,U=>O(u,U),()=>c(u)),R(()=>ut(N,"viewBox",`0 0 ${h.width} ${h.height}`)),F(L,N)},$$slots:{default:!0}}),v(g),F(l,g),ve()}var fa=A("<!> <!> <!>",1),ma=A('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Aa(l,f){oe(f,!1);const n=H(),e=H(),b=H();let s=X(f,"stats",8,null),o=X(f,"showRevlog",8,!0),C=X(f,"showCurve",8,!0);j(()=>J(s()),()=>{var u;O(n,((u=s())==null?void 0:u.memoryState)!=null)}),j(()=>J(s()),()=>{var u,h;O(e,(h=(u=s())==null?void 0:u.desiredRetention)!=null?h:.9)}),j(()=>J(s()),()=>{O(b,(()=>{var h,S,a,d,g,p;const u=(a=(S=(h=s())==null?void 0:h.fsrsParams)==null?void 0:S.length)!=null?a:0;return u===0?.1542:u<21?.5:(p=(g=(d=s())==null?void 0:d.fsrsParams)==null?void 0:g[20])!=null?p:.1542})())}),pe(),ne();var t=ma(),r=me(t);ht(r,()=>({"--gutter-inline":"1rem","--gutter-block":"0.5rem"})),bt(r.lastChild,{breakpoint:"md",children:(u,h)=>{var S=Re(),a=me(S);{var d=p=>{var E=fa(),I=me(E);he(I,{children:(w,T)=>{zt(w,{get stats(){return s()}})},$$slots:{default:!0}});var L=_(I,2);{var M=w=>{he(w,{children:(T,U)=>{la(T,{get revlog(){return s().revlog},get fsrsEnabled(){return c(n)}})},$$slots:{default:!0}})};te(L,w=>{o()&&w(M)})}var N=_(L,2);{var i=w=>{he(w,{children:(T,U)=>{ua(T,{get revlog(){return s().revlog},get desiredRetention(){return c(e)},get decay(){return c(b)}})},$$slots:{default:!0}})};te(N,w=>{c(n)&&C()&&w(i)})}F(p,E)},g=p=>{Gt(p,{})};te(a,p=>{s()?p(d):p(g,!1)})}F(u,S)},$$slots:{default:!0}}),v(r),F(l,t),ve()}export{Aa as C};

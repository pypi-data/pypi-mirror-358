import{g as t,r as i,h as n}from"./p-02a3464d.js";import{P as e}from"./p-31906486.js";function s(t){return"function"==typeof t}function r(t){const i=t((t=>{Error.call(t),t.stack=(new Error).stack}));return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}const o=r((t=>function(i){t(this),this.message=i?`${i.length} errors occurred during unsubscription:\n${i.map(((t,i)=>`${i+1}) ${t.toString()}`)).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=i}));function c(t,i){if(t){const n=t.indexOf(i);0<=n&&t.splice(n,1)}}class u{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const t of i)t.remove(this);else i.remove(this);const{initialTeardown:n}=this;if(s(n))try{n()}catch(i){t=i instanceof o?i.errors:[i]}const{_finalizers:e}=this;if(e){this._finalizers=null;for(const i of e)try{a(i)}catch(i){t=null!=t?t:[],i instanceof o?t=[...t,...i.errors]:t.push(i)}}if(t)throw new o(t)}}add(t){var i;if(t&&t!==this)if(this.closed)a(t);else{if(t instanceof u){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(i=this._finalizers)&&void 0!==i?i:[]).push(t)}}_hasParent(t){const{_parentage:i}=this;return i===t||Array.isArray(i)&&i.includes(t)}_addParent(t){const{_parentage:i}=this;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t}_removeParent(t){const{_parentage:i}=this;i===t?this._parentage=null:Array.isArray(i)&&c(i,t)}remove(t){const{_finalizers:i}=this;i&&c(i,t),t instanceof u&&t._removeParent(this)}}u.EMPTY=(()=>{const t=new u;return t.closed=!0,t})();const l=u.EMPTY;function h(t){return t instanceof u||t&&"closed"in t&&s(t.remove)&&s(t.add)&&s(t.unsubscribe)}function a(t){s(t)?t():t.unsubscribe()}const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(t,i,...n){const{delegate:e}=d;return(null==e?void 0:e.setTimeout)?e.setTimeout(t,i,...n):setTimeout(t,i,...n)},clearTimeout(t){const{delegate:i}=d;return((null==i?void 0:i.clearTimeout)||clearTimeout)(t)},delegate:void 0};function v(){}const b=p("C",void 0,void 0);function p(t,i,n){return{kind:t,value:i,error:n}}function m(t){t()}class g extends u{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,h(t)&&t.add(this)):this.destination=S}static create(t,i,n){return new k(t,i,n)}next(t){this.isStopped?O(function(t){return p("N",t,void 0)}(t),this):this._next(t)}error(t){this.isStopped?O(p("E",void 0,t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?O(b,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const w=Function.prototype.bind;function _(t,i){return w.call(t,i)}class y{constructor(t){this.partialObserver=t}next(t){const{partialObserver:i}=this;if(i.next)try{i.next(t)}catch(t){x(t)}}error(t){const{partialObserver:i}=this;if(i.error)try{i.error(t)}catch(t){x(t)}else x(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(t){x(t)}}}class k extends g{constructor(t,i,n){let e;if(super(),s(t)||!t)e={next:null!=t?t:void 0,error:null!=i?i:void 0,complete:null!=n?n:void 0};else{let i;this&&f.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),e={next:t.next&&_(t.next,i),error:t.error&&_(t.error,i),complete:t.complete&&_(t.complete,i)}):e=t}this.destination=new y(e)}}function x(t){var i;i=t,d.setTimeout((()=>{const{onUnhandledError:t}=f;if(!t)throw i;t(i)}))}function O(t,i){const{onStoppedNotification:n}=f;n&&d.setTimeout((()=>n(t,i)))}const S={closed:!0,next:v,error:function(t){throw t},complete:v},j="function"==typeof Symbol&&Symbol.observable||"@@observable";function E(t){return t}class A{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new A;return i.source=this,i.operator=t,i}subscribe(t,i,n){const e=(r=t)&&r instanceof g||function(t){return t&&s(t.next)&&s(t.error)&&s(t.complete)}(r)&&h(r)?t:new k(t,i,n);var r;return m((()=>{const{operator:t,source:i}=this;e.add(t?t.call(e,i):i?this._subscribe(e):this._trySubscribe(e))})),e}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=C(i))(((i,n)=>{const e=new k({next:i=>{try{t(i)}catch(t){n(t),e.unsubscribe()}},error:n,complete:i});this.subscribe(e)}))}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[j](){return this}pipe(...t){return(0===(i=t).length?E:1===i.length?i[0]:function(t){return i.reduce(((t,i)=>i(t)),t)})(this);var i}toPromise(t){return new(t=C(t))(((t,i)=>{let n;this.subscribe((t=>n=t),(t=>i(t)),(()=>t(n)))}))}}function C(t){var i;return null!==(i=null!=t?t:f.Promise)&&void 0!==i?i:Promise}A.create=t=>new A(t);const P=r((t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}));class $ extends A{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new D(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new P}next(t){m((()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}}))}error(t){m((()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}}))}complete(){m((()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}}))}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:n,observers:e}=this;return i||n?l:(this.currentObservers=null,e.push(t),new u((()=>{this.currentObservers=null,c(e,t)})))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:n,isStopped:e}=this;i?t.error(n):e&&t.complete()}asObservable(){const t=new A;return t.source=this,t}}$.create=(t,i)=>new D(t,i);class D extends ${constructor(t,i){super(),this.destination=t,this.source=i}next(t){var i,n;null===(n=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===n||n.call(i,t)}error(t){var i,n;null===(n=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===n||n.call(i,t)}complete(){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===i||i.call(t)}_subscribe(t){var i,n;return null!==(n=null===(i=this.source)||void 0===i?void 0:i.subscribe(t))&&void 0!==n?n:l}}class M extends ${constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const i=super._subscribe(t);return!i.closed&&t.next(this._value),i}getValue(){const{hasError:t,thrownError:i,_value:n}=this;if(t)throw i;return this._throwIfClosed(),n}next(t){super.next(this._value=t)}}function T(t){return t}function z(t,i){return(n,e)=>{const s=function(t,i,n,e){let s=F.get(t);return s||(s=[],F.set(t,s)),s.push({options:n,name:i,optionFactory:e.optionFactory||T,service:{name:e.name,method:e.method||"subscribe"}}),s}(n,e,t,i);1===s.length&&function(t,i){t.connectedCallback=U(t.connectedCallback,i),t.componentWillLoad=function(t,i){return async function(...n){return!0===N.get(this)?(await I(this),t?t.apply(this,n):void 0):U(t,i).apply(this,n)}}(t.componentWillLoad,i),t.componentDidUnload=B(t.componentDidUnload),t.disconnectedCallback=B(t.disconnectedCallback)}(n,s)}}const F=new WeakMap,H=new WeakMap,N=new WeakMap;function U(i,n){return async function(...e){N.set(this,!0),H.set(this,[]),await I(this);const s=new M(this.context);if(function(i,n,e){const s=t(i),{get:r,set:o}=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(s),n);Object.defineProperty(s,n,{configurable:!0,get:r,set:function(t){o.call(this,t),e.next(t)}})}(this,"context",s),n.forEach((t=>{t.options=t.optionFactory(t.options,this),"context"in t.options&&(t.options.context=s),function(t,i){const n=function(t,i){const n=Object.assign({},i.options);!function(t,i){t.filter&&(t.filter=t.filter.map((t=>t.bind(i)))),t.map&&(t.map=t.map.map((t=>t.bind(i))))}(n,t);const e=i.service.name,s=t.platform;if(!s.has(e))throw new Error(`Service ${e} does not exist`);return s.get(e)[i.service.method](function(t,i){return n=>{t[i]=n}}(t,i.name),n)}(t,i);H.get(t).push(n)}(this,t)})),i)return i.apply(this,e)}}function B(t){return async function(...i){let n;return t&&(n=t.apply(this,i)),H.get(this).forEach((t=>t())),H.set(this,[]),n}}function I(t){const i=[];return t.platform||i.push(R(t,"platform")),t.context||i.push(R(t,"context")),i.length?Promise.all(i):Promise.resolve()}function R(i,n){const e=t(i);return new Promise((t=>{Object.defineProperty(e,n,{configurable:!0,set:i=>{delete e[n],e[n]=i,t()}})}))}function W(t){const{limetype:i,id:n}=this.context;if(t[i])return t[i].find((t=>t.id===n))}function L(t){return t.session}var Z=function(t,i,n,e){var s,r=arguments.length,o=r<3?i:null===e?e=Object.getOwnPropertyDescriptor(i,n):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,n,e);else for(var c=t.length-1;c>=0;c--)(s=t[c])&&(o=(r<3?s(o):r>3?s(i,n,o):s(i,n))||o);return r>3&&o&&Object.defineProperty(i,n,o),o};const q=class{constructor(t){i(this,t),this.document={},this.isOpen=!1,this.allowedExtensions=Object.freeze(["PDF","DOC","DOCX"]),this.setCloneDocument=t=>{t.stopPropagation(),this.cloneDocument=t.detail},this.openDialog=()=>{this.isOpen=!0},this.closeDialog=()=>{this.isOpen=!1}}goToScrive(t,i){var n;const{scriveHost:e,includePerson:s,includeCoworker:r,target:o}=null===(n=this.config)||void 0===n?void 0:n.limepkg_scrive;window.open(`${e}/public/?limeDocId=${t}&lang=${this.session.language}&usePerson=${s}&useCoworker=${r}&cloneDocument=${this.cloneDocument}&scriveDocId=${i}`,o)}files(){var t;const i=(null===(t=this.document)||void 0===t?void 0:t._files)||{};return Object.keys(i).map((t=>i[t]))}isSignable(t){return this.allowedExtensions.includes((t.extension||"").toUpperCase())}render(){var t,i;if("document"!==this.context.limetype)return;const s=this.files().filter(this.isSignable,this);if(0===s.length||s.length>1)return;const r=this.platform.get(e.Translate),o=r.get("limepkg_scrive.primary_action"),c=r.get("limepkg_scrive.clone_document"),u=r.get("limepkg_scrive.clone_hint"),l=r.get("limepkg_scrive.clone_info"),h=r.get("limepkg_scrive.ok");return n("section",null,n("limel-button",{id:"scrive_esign_button",label:o,outlined:!0,icon:"signature",onClick:()=>{var t;return this.goToScrive(this.context.id,null===(t=this.document)||void 0===t?void 0:t.scrive_document_id)}}),n("p",null,n("limel-flex-container",{justify:"start"},n("limel-checkbox",{label:c,checked:this.cloneDocument&&(null===(i=null===(t=this.config)||void 0===t?void 0:t.limepkg_scrive)||void 0===i?void 0:i.cloneDocument),onChange:this.setCloneDocument}),n("limel-icon-button",{icon:"question_mark",label:u,onClick:this.openDialog}))),n("limel-dialog",{open:this.isOpen,onClose:this.closeDialog},n("p",null,l),n("limel-button",{label:h,onClick:this.closeDialog,slot:"button"})))}};var V;Z([function(t={}){const i={name:e.LimeObjectRepository};return t.map=[W,...t.map||[]],t.context=null,z(t,i)}()],q.prototype,"document",void 0),Z([function(t={}){const i={name:e.Application};return t.map=[L,...t.map||[]],z(t,i)}()],q.prototype,"session",void 0),Z([(V={},z(V,{name:e.ConfigRepository}))],q.prototype,"config",void 0),q.style=".container{margin-left:1.25rem;margin-right:1.25rem}#scrive_esign_button{isolation:isolate;position:relative}#scrive_esign_button:after{content:\"\";display:block;width:1.5rem;height:1.5rem;position:absolute;z-index:1;top:0;left:0.25rem;bottom:0;margin:auto;background-image:url(\"data:image/svg+xml; utf8, <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128.9 116.04'><defs><style>.cls-1{fill:none;}.cls-2{fill:%2327282d;}</style></defs><g id='Layer_2' data-name='Layer 2'><g id='S_Mark_Dark' data-name='S Mark Dark'><g id='S_Black' data-name='S Black'><rect class='cls-1' width='128.9' height='116.04'/><path class='cls-2' d='M65.51,65.48a29.87,29.87,0,0,1,7.76,2,7.3,7.3,0,0,1,3.62,3,8.64,8.64,0,0,1,1,4.35A10.34,10.34,0,0,1,76,80.71a12.35,12.35,0,0,1-4.64,3.53c-4.65,2.1-11.05,2.69-16.06,2.73A40.35,40.35,0,0,1,44,85.53,20.24,20.24,0,0,1,36.8,82,13.63,13.63,0,0,1,33,77.1,13.1,13.1,0,0,1,31.86,72H17.67A28.57,28.57,0,0,0,20.6,83a22,22,0,0,0,6.22,7.55,31.48,31.48,0,0,0,8.63,4.6,48.07,48.07,0,0,0,9.91,2.31,75.66,75.66,0,0,0,10.35.63c10.94,0,25-2.14,32.12-11.44A22.22,22.22,0,0,0,92.07,73.2a18,18,0,0,0-1.61-7.8A19.6,19.6,0,0,0,86,59.48a22.44,22.44,0,0,0-6.43-4,29.84,29.84,0,0,0-7.69-2.1C63.47,52.2,44.59,50.46,39.22,48A7.21,7.21,0,0,1,35.56,45a7.69,7.69,0,0,1-1-4.3,8.74,8.74,0,0,1,1.72-5.52,12.69,12.69,0,0,1,4.6-3.53,26.67,26.67,0,0,1,6.37-1.85,43.93,43.93,0,0,1,6.88-.55,34.38,34.38,0,0,1,12.25,2,17.4,17.4,0,0,1,7.35,5,11.88,11.88,0,0,1,2.67,7H90.64A27.58,27.58,0,0,0,87.9,33.17a24.4,24.4,0,0,0-6.73-8,31.92,31.92,0,0,0-11-5.19,60.15,60.15,0,0,0-15.84-1.92A52.27,52.27,0,0,0,36.22,21a25.4,25.4,0,0,0-11.67,8.24,20.92,20.92,0,0,0-4.17,13A18.17,18.17,0,0,0,26.49,56,22.45,22.45,0,0,0,32.92,60a29.63,29.63,0,0,0,7.61,2.06C48.91,63.23,57.21,64.37,65.51,65.48Z'/><path class='cls-2' d='M111.23,89.19a8.84,8.84,0,1,1-8.84-8.88A8.87,8.87,0,0,1,111.23,89.19Z'/></g></g></g></svg>\");background-color:var(--lime-elevated-surface-background-color);background-size:contain;background-repeat:no-repeat;background-position:center}";export{q as lwc_limepkg_scrive_main}